# STM32F103C8x连接4针OLED(SSD1306)笔记

### 1. 前期准备
##### 1.1 准备的材料

|  |
|:--------:|
|    STM32F103C8T6核心板    |
|    0.96寸4针OLED显示屏     |
|    STM8/32—ST Link下载器     |
|    若干杜邦线     |

##### 1.2 STM8/32—ST Link下载的使用
第一步：需要安装ST Link下载器的驱动（[ST Link相关文件下载地址与提取码：70vm](https://pan.baidu.com/s/1zJun9v2HfKDSawJu6ho1Wg)）
第二步：安装好之后我们可以参考以下的ST-Link配置视频[ST-Link下载器配置视频](https://v.youku.com/v_show/id_XNDY3MjkyNjgxNg==.html)
第三步：调试好之后我们就可以进行OLED的学习了

### 2. OLED0.96寸4针驱动芯片手册SSD1306规格书阅读
Ps:规格书参考以下链接[ 提取码：by4b](https://pan.baidu.com/s/1kxvjMKs9ziM_sxuBuyxyew)

##### 2.1 小白必知必会
Q1：拿到一个芯片文档之后，我们需要看那些内容呢？
A1：我们需要知道我们的目的。如果我们的目的是绘制PCB的话，那么我们需要看该芯片手册是Package Information（设计参数）；如果我们的目的是进行编程的话，我们需要看芯片的Functional Block description（功能函数块）部分。这样我们就可以快速定位了。当然，今天我们的目的是进行编程学习，那么我们拿到数据手册之后就直接定位至函数交互部分。

##### 2.2 OLED中I^2^C的理解
**2.2.1 OLED模式选择及引脚说明**
OLED中I^2^C 共4根引线，分别为SDA、SCL、VCC、GND。其中，SDA为数据总线，SCL为数据时钟总线，VCC和GND分别是3.5/5V接线与地线。因为我们购买的0.96寸的OLED为封装好的显示器，提前已经进行了I^2^C的模式预置，所以我们直接可以进行I^2^C的配置。
如果购买的是直接的屏幕自己进行封装的话，其数据的读写模式还可以选择8080、6800、SPI3线/4线等

**2.2.2 OLED中I^2^C接口操作**
I^2^C的接口包括SA0（地址总线）、SDA~out~/D~2~（数据输出）、SDA~in~/D~1~（数据输入）和SCL（D~0~时钟信号线）。（Ps：当我们设计PCB时，以上接口都必须连接上拉电阻且RES#用于初始化设备）。具体介绍如下：
**a)SA0：**在数据通信前**必须**要设置的地址总线，该设备（当前OLED显示器）的地址线的设置和读写模式的选择遵循以下格式（如果各位买的不是同一型号的话，请具体参考数据手册）

| b7 | b6 | b5 | b4 | b3 | b2 | b1 | b0 |
|:--------:|
| 0 | 1 | 1 | 1 | 1 | 0 | SA0 | R/W# |

根据以上的表格我们可以知道，我们可以通过设置0位的来选择读写模式，模式的选择见下表:

| 读模式Read | 写模式Write |
|:--------:|
| R/W#=1 | R/W#=0 |

**b)SDA：**其含义为数据传输总线，一般该总线在PCB设计时直接引出引脚供用户传输数据，I^2^C即可传输数据也可以接受数据。在OLED屏幕中我们是为了进行数据的展示，所以在该设备中必须把SDA~in~连接值SDA总线中，而SDA~out~可以不用连接。因为我们不进行从I^2^C中获取数据，那么我们就不连接SDA~out~，这样操作后ACK信号在总线中将会被忽略。
**c)SCL：**在使用I^2^C进行数据的传输时，我们必须通过I^2^C时钟信号总线作为我们的时间参考周期。
接下来我们就进行细致的I^2^C总线写数据的学习。

**2.2.3 I^2^C总线写数据**
此款I^2^C写数据遵循以下时序，时序图为：
![I^2^C写数据时序图](https://github.com/dreamofTaotao/markdown_upload_picture/blob/main/IIC%E5%86%99%E6%95%B0%E6%8D%AE%E6%97%B6%E5%BA%8F%E5%9B%BE.png)

根据上图我们已经能够清晰的了解到我们对OLED I^2^C的总线操作，其顺序为：
**++ start ——> 0x0c(写模式设置) ——> data change ——> stop ++**

**2.2.4 I^2^C总线写数据具体解释及操作：**

**1. start：**I^2^C开始运行，开始运行条件为保持SCL为高电平同时将SDA由高电平拉为低电平

**2. 设置写模式：**向I^2^C发出数据0x0c(b0111100)

**3. ACK设置：**当收到一个数据之后，ACK信号将会生成。

**4. 设置Co、D/C#：**

**4.1 Co：**当Co被设置为逻辑0的时候，那么传输的信息将只包含数据位。

**4.2 D/C#：**D/C#决定了下一次传输的数据是命令还是数据。当D/C#设置为逻辑0时，那么下一次的传输信息为命令；如果D/C#设置为逻辑1时，下一次的传输信息将会是数据并且存储在GDDRAM中。

**5. ACK回应：**ACK将会在收到每个控制位或者数据位之后。

**6. stop：**I^2^C停止运行，停止运行的条件为保持SCL为高电平同时将SDA~in~由低电平拉为高电平。

【注意：当传输数据位有限制。限制1：在每一次SCL脉冲期间传输的数据位必须在高电平时钟期间保持稳定的状态。除了开始或者停止I^2^C的条件以外，数据线仅能在SCL时钟线保持低电平状态时进行数据交换；限制2：SCL和SDA总线应该被外部电阻拉高。】

至此为止，以上第二部分0.96寸OLED中I^2^C时序基本操作已经讲解完毕，接下来我们将进行代码的编写工作。

### 3. OLED0.96寸4针SSD1306显示器驱动编程代码实战






















